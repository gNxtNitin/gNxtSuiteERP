
CREATE TABLE INV_STOCK_REC_TRN2006 AS
SELECT * FROM INV_STOCK_REC_TRN WHERE 
COMPANY_CODE=1 AND FYEAR=2006;

CREATE TABLE INV_STOCK_REC_TRN2005 AS
SELECT * FROM INV_STOCK_REC_TRN WHERE 
COMPANY_CODE=1 AND FYEAR=2005;

CREATE TABLE INV_STOCK_REC_TRN2004 AS
SELECT * FROM INV_STOCK_REC_TRN WHERE 
COMPANY_CODE=1 AND FYEAR=2004;


CREATE TABLE INV_STOCK_REC_TRN2003 AS
SELECT * FROM INV_STOCK_REC_TRN WHERE 
COMPANY_CODE=1 AND FYEAR=2003;

CREATE TABLE INV_STOCK_REC_TRN2002 AS
SELECT * FROM INV_STOCK_REC_TRN WHERE 
COMPANY_CODE=1 AND FYEAR=2002;



ALTER TABLE INV_STOCK_REC_TRN2006 ADD (
CONSTRAINT INV_STOCK2006_PK PRIMARY KEY (COMPANY_CODE, FYEAR, SERIAL_NO, STOCK_ID, STOCK_TYPE, REF_TYPE, REF_NO,ITEM_CODE),
CONSTRAINT INV_STOCK2006_ITEM_FK FOREIGN KEY (COMPANY_CODE,ITEM_CODE) REFERENCES INV_ITEM_MST(COMPANY_CODE,ITEM_CODE),
CONSTRAINT INV_STOCK2006_TYPE_FK FOREIGN KEY (COMPANY_CODE,STOCK_TYPE) REFERENCES NV_TYPE_MST(COMPANY_CODE,STOCK_TYPE_CODE));
);


ALTER TABLE INV_STOCK_REC_TRN2005 ADD (
CONSTRAINT INV_STOCK2005_PK PRIMARY KEY (COMPANY_CODE, FYEAR, SERIAL_NO, STOCK_ID, STOCK_TYPE, REF_TYPE, REF_NO,ITEM_CODE),
CONSTRAINT INV_STOCK2005_ITEM_FK FOREIGN KEY (COMPANY_CODE,ITEM_CODE) REFERENCES INV_ITEM_MST(COMPANY_CODE,ITEM_CODE),
CONSTRAINT INV_STOCK2005_TYPE_FK FOREIGN KEY (COMPANY_CODE,STOCK_TYPE) REFERENCES NV_TYPE_MST(COMPANY_CODE,STOCK_TYPE_CODE));
);

ALTER TABLE INV_STOCK_REC_TRN2004 ADD (
CONSTRAINT INV_STOCK2004_PK PRIMARY KEY (COMPANY_CODE, FYEAR, SERIAL_NO, STOCK_ID, STOCK_TYPE, REF_TYPE, REF_NO,ITEM_CODE),
CONSTRAINT INV_STOCK2004_ITEM_FK FOREIGN KEY (COMPANY_CODE,ITEM_CODE) REFERENCES INV_ITEM_MST(COMPANY_CODE,ITEM_CODE),
CONSTRAINT INV_STOCK2004_TYPE_FK FOREIGN KEY (COMPANY_CODE,STOCK_TYPE) REFERENCES NV_TYPE_MST(COMPANY_CODE,STOCK_TYPE_CODE));
);

ALTER TABLE INV_STOCK_REC_TRN2003 ADD (
CONSTRAINT INV_STOCK2003_PK PRIMARY KEY (COMPANY_CODE, FYEAR, SERIAL_NO, STOCK_ID, STOCK_TYPE, REF_TYPE, REF_NO,ITEM_CODE),
CONSTRAINT INV_STOCK2003_ITEM_FK FOREIGN KEY (COMPANY_CODE,ITEM_CODE) REFERENCES INV_ITEM_MST(COMPANY_CODE,ITEM_CODE),
CONSTRAINT INV_STOCK2003_TYPE_FK FOREIGN KEY (COMPANY_CODE,STOCK_TYPE) REFERENCES NV_TYPE_MST(COMPANY_CODE,STOCK_TYPE_CODE));
);

ALTER TABLE INV_STOCK_REC_TRN2002 ADD (
CONSTRAINT INV_STOCK2002_PK PRIMARY KEY (COMPANY_CODE, FYEAR, SERIAL_NO, STOCK_ID, STOCK_TYPE, REF_TYPE, REF_NO,ITEM_CODE),
CONSTRAINT INV_STOCK2002_ITEM_FK FOREIGN KEY (COMPANY_CODE,ITEM_CODE) REFERENCES INV_ITEM_MST(COMPANY_CODE,ITEM_CODE),
CONSTRAINT INV_STOCK2002_TYPE_FK FOREIGN KEY (COMPANY_CODE,STOCK_TYPE) REFERENCES NV_TYPE_MST(COMPANY_CODE,STOCK_TYPE_CODE));
);


CREATE INDEX INDEX_STOCK_2006_1 ON INV_STOCK_REC_TRN2006(STOCK_ID) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_2 ON INV_STOCK_REC_TRN2006(ITEM_CODE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_3 ON INV_STOCK_REC_TRN2006(STOCK_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_4 ON INV_STOCK_REC_TRN2006(REF_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_5 ON INV_STOCK_REC_TRN2006(E_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_6 ON INV_STOCK_REC_TRN2006(REF_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_7 ON INV_STOCK_REC_TRN2006(REF_NO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_8 ON INV_STOCK_REC_TRN2006(DEPT_CODE_TO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2006_9 ON INV_STOCK_REC_TRN2006(DEPT_CODE_FROM) TABLESPACE INDX;

CREATE INDEX INDEX_STOCK_2005_1 ON INV_STOCK_REC_TRN2006(STOCK_ID) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_20056_2 ON INV_STOCK_REC_TRN2006(ITEM_CODE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_3 ON INV_STOCK_REC_TRN2006(STOCK_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_4 ON INV_STOCK_REC_TRN2006(REF_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_5 ON INV_STOCK_REC_TRN2006(E_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_6 ON INV_STOCK_REC_TRN2006(REF_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_7 ON INV_STOCK_REC_TRN2006(REF_NO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_8 ON INV_STOCK_REC_TRN2006(DEPT_CODE_TO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2005_9 ON INV_STOCK_REC_TRN2006(DEPT_CODE_FROM) TABLESPACE INDX;


CREATE INDEX INDEX_STOCK_2004_1 ON INV_STOCK_REC_TRN2006(STOCK_ID) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_2 ON INV_STOCK_REC_TRN2006(ITEM_CODE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_3 ON INV_STOCK_REC_TRN2006(STOCK_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_4 ON INV_STOCK_REC_TRN2006(REF_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_5 ON INV_STOCK_REC_TRN2006(E_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_6 ON INV_STOCK_REC_TRN2006(REF_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_7 ON INV_STOCK_REC_TRN2006(REF_NO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_8 ON INV_STOCK_REC_TRN2006(DEPT_CODE_TO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2004_9 ON INV_STOCK_REC_TRN2006(DEPT_CODE_FROM) TABLESPACE INDX;

CREATE INDEX INDEX_STOCK_2003_1 ON INV_STOCK_REC_TRN2006(STOCK_ID) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_2 ON INV_STOCK_REC_TRN2006(ITEM_CODE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_3 ON INV_STOCK_REC_TRN2006(STOCK_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_4 ON INV_STOCK_REC_TRN2006(REF_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_5 ON INV_STOCK_REC_TRN2006(E_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_6 ON INV_STOCK_REC_TRN2006(REF_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_7 ON INV_STOCK_REC_TRN2006(REF_NO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_8 ON INV_STOCK_REC_TRN2006(DEPT_CODE_TO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2003_9 ON INV_STOCK_REC_TRN2006(DEPT_CODE_FROM) TABLESPACE INDX;

CREATE INDEX INDEX_STOCK_2002_1 ON INV_STOCK_REC_TRN2006(STOCK_ID) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_2 ON INV_STOCK_REC_TRN2006(ITEM_CODE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_3 ON INV_STOCK_REC_TRN2006(STOCK_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_4 ON INV_STOCK_REC_TRN2006(REF_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_5 ON INV_STOCK_REC_TRN2006(E_DATE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_6 ON INV_STOCK_REC_TRN2006(REF_TYPE) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_7 ON INV_STOCK_REC_TRN2006(REF_NO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_8 ON INV_STOCK_REC_TRN2006(DEPT_CODE_TO) TABLESPACE INDX;
CREATE INDEX INDEX_STOCK_2002_9 ON INV_STOCK_REC_TRN2006(DEPT_CODE_FROM) TABLESPACE INDX;

***************************************************************************************************************************
AND INV.COMPANY_CODE=1 
 AND INV.FYEAR=2006
 AND INV.STOCK_ID='WH'
 AND INV.STOCK_TYPE IN ('CS','ST','RJ','QC') 
 AND REF_DATE<=TO_DATE('15-Nov-2006') 

Where 
 STOCK.COMPANY_CODE=1 
 AND STOCK.FYEAR=2006
 AND STOCK.STOCK_ID='WH'
 AND STOCK.COMPANY_CODE=ITEM.COMPANY_CODE 
 AND STOCK.ITEM_CODE=ITEM.ITEM_CODE 
 AND REF_DATE<=TO_DATE('30-Apr-2006') 




	CREATE INDEX INDEX_STOCK_2006_1 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,ITEM_CODE,REF_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_2 ON INV_STOCK_REC_TRN2006 (COMPANY_CODE, ITEM_CODE, STOCK_ID, STOCK_TYPE, REF_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_3 ON INV_STOCK_REC_TRN2006 (COMPANY_CODE, FYEAR, REF_TYPE, ITEM_CODE, REF_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_4 ON INV_STOCK_REC_TRN2006 (COMPANY_CODE, FYEAR, REF_TYPE, REF_NO) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_5 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,REF_NO,REF_TYPE,STOCK_TYPE) TABLESPACE INDX;

	CREATE INDEX INDEX_STOCK_2006_6 ON INV_STOCK_REC_TRN2006 (COMPANY_CODE, FYEAR, STOCK_ID, STOCK_TYPE, REF_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_7 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,E_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_8 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,DEPT_CODE_TO) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_9 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,DEPT_CODE_FROM) TABLESPACE INDX;

	CREATE INDEX INDEX_STOCK_2006_10 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,FYEAR,ITEM_CODE,STOCK_ID,STOCK_TYPE,REF_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_11 ON INV_STOCK_REC_TRN2006(COMPANY_CODE,ITEM_CODE) TABLESPACE INDX;

	CREATE INDEX INDEX_STOCK_2006_12 ON INV_STOCK_REC_TRN2006 (COMPANY_CODE, FYEAR, STOCK_ID, STOCK_TYPE, REF_DATE) TABLESPACE INDX;
        CREATE INDEX INDEX_STOCK_2006_13 ON INV_STOCK_REC_TRN2006(COMPANY_CODE, FYEAR, STOCK_ID, STOCK_TYPE, E_DATE, DEPT_CODE_FROM, DEPT_CODE_TO, REF_TYPE || REF_NO, ITEM_CODE, REF_DATE) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_14 ON INV_STOCK_REC_TRN2006 (COMPANY_CODE, FYEAR) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_15 ON INV_STOCK_REC_TRN2006 (STOCK_ID) TABLESPACE INDX;
	CREATE INDEX INDEX_STOCK_2006_16 ON INV_STOCK_REC_TRN2006(E_DATE) TABLESPACE INDX;


	


	CREATE INDEX INDEX_STOCK_2006_17 ON INV_STOCK_REC_TRN2006
	(COMPANY_CODE, FYEAR, STOCK_ID, STOCK_TYPE, ITEM_CODE, 
	REF_DATE) TABLESPACE INDX;

        CREATE INDEX INDEX_STOCK_2006_18 ON INV_STOCK_REC_TRN2006(COMPANY_CODE, FYEAR, STOCK_ID, 
	STOCK_TYPE, E_DATE, DEPT_CODE_FROM,
	REF_TYPE || REF_NO, ITEM_CODE, REF_DATE)  TABLESPACE INDX;

	CREATE INDEX INDEX_STOCK_2006_19 ON INV_STOCK_REC_TRN2006(COMPANY_CODE, FYEAR, STOCK_ID, 
	STOCK_TYPE, E_DATE, DEPT_CODE_TO, 
	REF_TYPE || REF_NO, ITEM_CODE, REF_DATE)  TABLESPACE INDX;




ALTER INDEX INDEX_STOCK_2006_10  REBUILD COMPUTE STATISTICS ;
ALTER INDEX INDEX_STOCK_2006_11  REBUILD COMPUTE STATISTICS ;